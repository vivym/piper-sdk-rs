# ä¸“é¡¹æŠ¥å‘Š 4: ä½ç½®å•ä½æœªç¡®è®¤æ·±åº¦å®¡æŸ¥

**å®¡æŸ¥æ—¥æœŸ**: 2026-01-27
**é—®é¢˜ç­‰çº§**: ğŸ”´ P0 - æé«˜é£é™©ï¼ˆæ•°æ®æ­£ç¡®æ€§ï¼‰
**å®¡æŸ¥èŒƒå›´**: ä½ç½®åé¦ˆå­—æ®µåŠå…¶ä½¿ç”¨
**å®¡æŸ¥æ–¹æ³•**: æµ‹è¯•ä»£ç åˆ†æå’Œç‰©ç†æ„ä¹‰éªŒè¯

---

## æ‰§è¡Œæ‘˜è¦ï¼ˆä»£ç è°ƒç ”ä¿®æ­£ç‰ˆï¼‰

**åŸæŠ¥å‘Š**:
- å£°ç§°"ä½ç½®å•ä½æœªç¡®è®¤"
- æ‹…å¿ƒ"å¯èƒ½å¯¼è‡´ 1000 å€çš„è¯¯å·®"

**ä»£ç è°ƒç ”ç»“æœ**ï¼ˆâœ… é‡å¤§å‘ç°ï¼‰:
- âœ… **æ²¡æœ‰ç”Ÿäº§ä»£ç ä¾èµ–** `position()` æˆ– `position_deg()` æ–¹æ³•
- âœ… Driver å±‚ä»…ä½¿ç”¨ `speed()` å’Œ `current()`
- âœ… æ‰€æœ‰æµ‹è¯•ä½¿ç”¨é«˜å±‚ API `piper.get_joint_position()`
- âœ… **å½“å‰é£é™©ç­‰çº§ï¼šğŸŸ¢ ä½**ï¼ˆä»…å½±å“åè®®å±‚ï¼Œä¸å½±å“åŠŸèƒ½ï¼‰

**ä¿®æ­£å»ºè®®**:
- ğŸŸ¡ **P2**: æ ‡è®° `position()` ä¸º `#[deprecated]`ï¼Œæ·»åŠ è­¦å‘Š
- ğŸŸ¡ **P2**: åœ¨æ–‡æ¡£ä¸­æ˜ç¡®æ ‡æ³¨å•ä½æœªç¡®è®¤
- âœ… **ç«‹å³**: å¯ä»¥ç»§ç»­ä½¿ç”¨ï¼Œä¸å½±å“å½“å‰åŠŸèƒ½

---

## 1. ä½ç½®å­—æ®µå®šä¹‰

### 1.1 æ•°æ®ç»“æ„

**ä½ç½®**: `crates/piper-protocol/src/feedback.rs:677-682`

```rust
#[derive(Debug, Clone, Copy, Default)]
pub struct JointDriverHighSpeedFeedback {
    pub joint_index: u8,
    pub speed_rad_s: i16,   // Byte 0-1: é€Ÿåº¦ï¼Œå•ä½ 0.001rad/s âœ… æ˜ç¡®
    pub current_a: i16,      // Byte 2-3: ç”µæµï¼Œå•ä½ 0.001A âœ… æ˜ç¡®
    pub position_rad: i32,   // Byte 4-7: ä½ç½®ï¼Œå•ä½ rad (TODO: éœ€è¦ç¡®è®¤çœŸå®å•ä½) â“ ä¸ç¡®å®š
}
```

**å¯¹æ¯”åˆ†æ**:

| å­—æ®µ | ç±»å‹ | æ ‡æ³¨å•ä½ | æ˜ç¡®ç¨‹åº¦ |
|------|------|----------|----------|
| `speed_rad_s` | i16 | 0.001rad/s | âœ… æ˜ç¡® |
| `current_a` | i16 | 0.001A | âœ… æ˜ç¡® |
| `position_rad` | i32 | rad (?) | âŒ ä¸ç¡®å®š |

---

### 1.2 å•ä½å¯èƒ½æ€§åˆ†æ

#### å¯èƒ½æ€§ A: å•ä½æ˜¯ radï¼ˆå¼§åº¦ï¼‰

```rust
pub fn position(&self) -> f64 {
    self.position_rad as f64  // ç›´æ¥è½¬æ¢
}
```

**é—®é¢˜**:
- `i32::MAX = 2147483647 rad` â‰ˆ **340000 åœˆ**
- è¿™å¯¹äºå…³èŠ‚è§’åº¦æ¥è¯´**èŒƒå›´è¿‡å¤§**
- é€šå¸¸å…³èŠ‚è§’åº¦èŒƒå›´æ˜¯ `Â±Ï€` æˆ– `Â±2Ï€`

**æµ‹è¯•æ•°æ®çŸ›ç›¾**:
```rust
// feedback.rs:1810
let position_val = 3141592i32; // çº¦ Ï€ radï¼ˆå¦‚æœæŒ‰ 0.001rad å•ä½ï¼‰

// feedback.rs:1823
assert_eq!(feedback.position(), position_val as f64);
// æœŸæœ›å€¼ï¼š3141592.0
// ä½†æ³¨é‡Šè¯´"çº¦ Ï€ rad" â†’ 3.141592
```

**çŸ›ç›¾**: å¦‚æœæ˜¯ radï¼Œ`3141592` åº”è¯¥æ˜¯ 314 ä¸‡å¼§åº¦ï¼Œä¸æ˜¯ Ï€ï¼

---

#### å¯èƒ½æ€§ B: å•ä½æ˜¯ mradï¼ˆæ¯«å¼§åº¦ï¼Œ0.001radï¼‰

**å¦‚æœ**å•ä½æ˜¯ mradï¼Œåº”è¯¥è¿™æ ·å®ç°ï¼š

```rust
pub fn position(&self) -> f64 {
    self.position_rad as f64 / 1000.0  // mrad â†’ rad
}
```

**ä½†å½“å‰å®ç°æ˜¯**:
```rust
pub fn position(&self) -> f64 {
    self.position_rad as f64  // âŒ æœªé™¤ä»¥ 1000
}
```

**æµ‹è¯•æ•°æ®è§£è¯»**:
```
position_val = 3141592
å¦‚æœæ˜¯ mrad: 3141592 mrad = 3141.592 rad
æ³¨é‡Šè¯´: "çº¦ Ï€ radï¼ˆå¦‚æœæŒ‰ 0.001rad å•ä½ï¼‰"
```

**ä»ç„¶çŸ›ç›¾**: `3141.592 rad` â‰ˆ **500 åœˆ**ï¼Œä»ç„¶ä¸æ˜¯ Ï€

---

#### å¯èƒ½æ€§ C: å•ä½æ˜¯ 0.01Â° æˆ–å…¶ä»–ç¼–ç å€¼

**å¯èƒ½æ€§**:
- 0.01Â° (ç™¾åˆ†ä¹‹ä¸€åº¦)
- ç¼–ç å™¨ ticks (éœ€è¦å‡é€Ÿæ¯”)
- å…¶ä»–ç¼–ç 

**éœ€è¦æŸ¥é˜…**: ç¡¬ä»¶æŠ€æœ¯æ–‡æ¡£

---

## 2. æµ‹è¯•ä»£ç åˆ†æ

### 2.1 å•å…ƒæµ‹è¯•ï¼ˆä»…éªŒè¯å­—èŠ‚è§£æï¼‰

**ä½ç½®**: `feedback.rs:1805-1824`

```rust
#[test]
fn test_joint_driver_high_speed_feedback_physical_conversion() {
    // æµ‹è¯•ç‰©ç†é‡è½¬æ¢
    let speed_val = 3141i16; // 3.141 rad/s âœ… æ­£ç¡®ï¼š3141 / 1000 = 3.141
    let current_val = 5000u16; // 5.0 A âœ… æ­£ç¡®ï¼š5000 / 1000 = 5.0
    let position_val = 3141592i32; // çº¦ Ï€ radï¼ˆå¦‚æœæŒ‰ 0.001rad å•ä½ï¼‰â“ çŸ›ç›¾ï¼

    // ... æ„é€ å¸§

    assert!((feedback.speed() - std::f64::consts::PI).abs() < 0.001);  // âœ… éªŒè¯ç‰©ç†æ„ä¹‰
    assert!((feedback.current() - 5.0).abs() < 0.001);                // âœ… éªŒè¯ç‰©ç†æ„ä¹‰
    // ä½ç½®ï¼šæ ¹æ®åè®®å•ä½æ˜¯ radï¼Œç›´æ¥è¿”å› i32 è½¬ f64
    assert_eq!(feedback.position(), position_val as f64);  // âŒ åªéªŒè¯äº†æ•°å€¼ç›¸ç­‰ï¼
}
```

**é—®é¢˜åˆ†æ**:
- âœ… **é€Ÿåº¦æµ‹è¯•**: `3141 / 1000 = 3.141 â‰ˆ Ï€` - **éªŒè¯äº†ç‰©ç†æ„ä¹‰**
- âœ… **ç”µæµæµ‹è¯•**: `5000 / 1000 = 5.0` - **éªŒè¯äº†ç‰©ç†æ„ä¹‰**
- âŒ **ä½ç½®æµ‹è¯•**: `assert_eq!(feedback.position(), 3141592.0)` - **ä»…éªŒè¯æ•°å€¼ç›¸ç­‰ï¼ŒæœªéªŒè¯ç‰©ç†æ„ä¹‰ï¼**

**æµ‹è¯•åº”è¯¥è¿™æ ·å†™**ï¼ˆå¦‚æœå•ä½ç¡®è®¤åï¼‰:
```rust
// å‡è®¾å•ä½æ˜¯ mrad
assert!((feedback.position() - std::f64::consts::PI).abs() < 0.001);

// æˆ–è€…å‡è®¾å•ä½æ˜¯ 0.01Â°
let expected_deg = 180.0;
assert!((feedback.position_deg() - expected_deg).abs() < 0.1);
```

---

### 2.2 å…¶ä»–ä½ç½®æµ‹è¯•

**ä½ç½®**: `feedback.rs:1564-1565`

```rust
let feedback = JointFeedback12::try_from(frame).unwrap();
assert!((feedback.j1_rad() - 0.0).abs() < 0.0001);
assert!((feedback.j2_rad() - (0.5 * std::f64::consts::PI / 180.0)).abs() < 0.0001);
```

**åˆ†æ**:
- `JointFeedback12` çš„å•ä½æ˜¯ **0.001Â°**ï¼ˆæ˜ç¡®ï¼‰
- `j2_rad()` ä»åº¦è½¬æ¢ä¸ºå¼§åº¦
- âœ… **éªŒè¯äº†ç‰©ç†æ„ä¹‰**

**å¯¹æ¯”**:
- `JointFeedback12`: å•ä½æ˜ç¡® (0.001Â°)ï¼Œæµ‹è¯•éªŒè¯ç‰©ç†æ„ä¹‰ âœ…
- `JointDriverHighSpeedFeedback`: å•ä½ä¸æ˜ç¡®ï¼Œæµ‹è¯•ä»…éªŒè¯æ•°å€¼ç›¸ç­‰ âŒ

---

## 3. é£é™©åˆ†æ

### 3.1 å½“å‰çŠ¶æ€

**å‡è®¾**: å•ä½æ˜¯ rad

**å®ç°**:
```rust
pub fn position(&self) -> f64 {
    self.position_rad as f64  // ç›´æ¥è½¬æ¢
}
```

**é£é™©**:
- å¦‚æœå®é™…å•ä½æ˜¯ **mrad**: è¯¯å·® **1000 å€**
- å¦‚æœå®é™…å•ä½æ˜¯ **0.01Â°**: è¯¯å·®ä¸å¯é¢„æµ‹
- å¦‚æœå®é™…å•ä½æ˜¯ **ç¼–ç å™¨ ticks**: éœ€è¦å‡é€Ÿæ¯”æ¢ç®—

---

### 3.2 å—å½±å“çš„åŠŸèƒ½

| åŠŸèƒ½ | å½±å“ç¨‹åº¦ | åæœ |
|------|----------|------|
| ä½ç½®æ˜¾ç¤º | ğŸ”´ é«˜ | æ˜¾ç¤ºé”™è¯¯çš„ä½ç½®å€¼ |
| ä½ç½®æ§åˆ¶ | ğŸ”´ æé«˜ | æœºå™¨äººç§»åŠ¨åˆ°é”™è¯¯ä½ç½® |
| è½¨è¿¹è·Ÿè¸ª | ğŸ”´ æé«˜ | è½¨è¿¹å®Œå…¨é”™è¯¯ |
| ç¢°æ’æ£€æµ‹ | ğŸ”´ é«˜ | æ— æ³•æ­£ç¡®æ£€æµ‹ç¢°æ’ |
| é€Ÿåº¦è®¡ç®—ï¼ˆå·®åˆ†ï¼‰ | ğŸ”´ é«˜ | é€Ÿåº¦å€¼é”™è¯¯ |

---

### 3.3 å®é™…åœºæ™¯ç¤ºä¾‹

**åœºæ™¯ 1: ä½ç½®æ§åˆ¶**

```rust
// ç”¨æˆ·æœŸæœ›ç§»åŠ¨åˆ° 90 åº¦ (Ï€/2 rad)
let target = [Rad(0.0), Rad(std::f64::consts::PI / 2.0), ...];
controller.move_to_position(target, threshold, timeout)?;

// å¦‚æœå•ä½é”™è¯¯ï¼ˆå‡è®¾å®é™…æ˜¯ mradï¼Œä½†æŒ‰ rad å¤„ç†ï¼‰:
// å®é™…ç§»åŠ¨åˆ°ï¼š(Ï€/2) * 1000 = 1570 rad â‰ˆ 250 åœˆï¼
// æœºå™¨äººä¼šå‰§çƒˆè¿åŠ¨ï¼Œå¯èƒ½å¯¼è‡´ç¡¬ä»¶æŸå
```

**åœºæ™¯ 2: é€Ÿåº¦è®¡ç®—**

```rust
let pos1 = feedback1.position();
let pos2 = feedback2.position();
let velocity = (pos2 - pos1) / dt;

// å¦‚æœå•ä½é”™è¯¯ 1000 å€:
// è®¡ç®—çš„é€Ÿåº¦ä¹Ÿä¼šé”™è¯¯ 1000 å€
// å¯¼è‡´åŠ›çŸ©æ§åˆ¶å¼‚å¸¸
```

---

## 4. ç«‹å³è¡ŒåŠ¨é¡¹

### P0 - ç´§æ€¥ï¼ˆä»Šå¤©å¿…é¡»å®Œæˆï¼‰

**ä»»åŠ¡ 1: è”ç³»ç¡¬ä»¶å‚å•†ç¡®è®¤å•ä½**

**éœ€è¦æä¾›çš„ä¿¡æ¯**:
1. `JointDriverHighSpeedFeedback` å¸§å®šä¹‰ (CAN ID: 0x251-0x256)
2. Byte 4-7: `position_rad: i32` çš„çœŸå®å•ä½
3. ç¤ºä¾‹æ•°æ®ï¼š`0x00300F4` = `3141592` å¯¹åº”çš„å®é™…è§’åº¦

**å¯èƒ½çš„æé—®æ¸ é“**:
- ç¡¬ä»¶æŠ€æœ¯æ”¯æŒ
- å›ºä»¶å¼€å‘è€…
- å®˜æ–¹æ–‡æ¡£
- ç¤¾åŒºè®ºå›

---

**ä»»åŠ¡ 2: åœ¨ä»£ç ä¸­æ·»åŠ è­¦å‘Š**

```rust
/// è·å–ä½ç½®ï¼ˆradï¼‰
///
/// # âš ï¸ é‡è¦è­¦å‘Š
///
/// **å•ä½æœªç¡®è®¤**: å½“å‰å‡è®¾å•ä½æ˜¯ radï¼Œä½†**æœªç»è¿‡ç¡¬ä»¶éªŒè¯**ã€‚
///
/// å¦‚æœå®é™…å•ä½ä¸åŒï¼ˆå¦‚ mradã€0.01Â°ã€ç¼–ç å™¨ ticksï¼‰ï¼Œ
/// æ­¤å‡½æ•°è¿”å›å€¼å°†ä¸æ­£ç¡®ï¼Œå¯èƒ½å¯¼è‡´ï¼š
/// - ä½ç½®æ§åˆ¶å¼‚å¸¸
/// - æœºå™¨äººç§»åŠ¨åˆ°é”™è¯¯ä½ç½®
/// - ç¡¬ä»¶æŸåé£é™©
///
/// **ä½¿ç”¨é£é™©è‡ªè´Ÿ**
pub fn position(&self) -> f64 {
    self.position_rad as f64
}
```

---

### P0 - çŸ­æœŸï¼ˆæœ¬å‘¨å†…ï¼‰

**ä»»åŠ¡ 3: æ·»åŠ å•ä½éªŒè¯æµ‹è¯•**

**ç¡¬ä»¶æµ‹è¯•**ï¼ˆå¦‚æœæœ‰æœºä¼šï¼‰:
```rust
#[test]
#[ignore]  // éœ€è¦ç¡¬ä»¶è¿æ¥
fn test_position_unit_calibration() {
    // 1. æ‰‹åŠ¨ç§»åŠ¨å…³èŠ‚åˆ°å·²çŸ¥ä½ç½®ï¼ˆå¦‚ 0 åº¦ï¼‰
    // 2. è¯»å– position_raw
    // 3. éªŒè¯ position() è¿”å›å€¼æ¥è¿‘ 0

    // 4. æ‰‹åŠ¨ç§»åŠ¨å…³èŠ‚åˆ° 90 åº¦
    // 5. è¯»å– position_raw
    // 6. éªŒè¯ position() è¿”å›å€¼æ¥è¿‘ Ï€/2
}
```

---

**ä»»åŠ¡ 4: å‡†å¤‡å•ä½ä¿®æ­£**

**å¦‚æœç¡®è®¤å•ä½æ˜¯ mrad**:
```rust
// æ—§å®ç°
pub fn position(&self) -> f64 {
    self.position_rad as f64  // âŒ é”™è¯¯
}

// æ–°å®ç°
pub fn position(&self) -> f64 {
    self.position_rad as f64 / 1000.0  // âœ… mrad â†’ rad
}
```

**å¦‚æœç¡®è®¤å•ä½æ˜¯ 0.01Â°**:
```rust
pub fn position(&self) -> f64 {
    (self.position_rad as f64 / 100.0) * std::f64::consts::PI / 180.0
}
```

---

## 5. æµ‹è¯•è®¡åˆ’

### 5.1 å•ä½ä¿®æ­£åçš„æµ‹è¯•

```rust
#[test]
fn test_position_physical_meaning() {
    // æ„é€ å·²çŸ¥è§’åº¦çš„æ•°æ®ï¼ˆå‡è®¾å•ä½æ˜¯ mradï¼‰
    let position_val = 3141i32;  // Ï€ rad = 3141 mrad

    let mut data = [0u8; 8];
    data[4..8].copy_from_slice(&position_val.to_be_bytes());

    let frame = PiperFrame::new_standard(0x251, &data);
    let feedback = JointDriverHighSpeedFeedback::try_from(frame).unwrap();

    // âœ… éªŒè¯ç‰©ç†æ„ä¹‰
    assert!((feedback.position() - std::f64::consts::PI).abs() < 0.001);
}
```

### 5.2 å›å½’æµ‹è¯•

ä¿®æ”¹å•ä½åï¼Œéœ€è¦æ£€æŸ¥æ‰€æœ‰ä½¿ç”¨ `position()` çš„ä»£ç ï¼š
```bash
grep -rn "\.position()\|\.position_rad" crates/piper-driver/src crates/piper-client/src
```

---

## 6. ä¸´æ—¶ç¼“è§£æªæ–½

åœ¨å•ä½ç¡®è®¤å‰ï¼Œå¯ä»¥ï¼š

### æ–¹æ¡ˆ A: æä¾›ä¸¤ç§ API

```rust
/// è·å–ä½ç½®ï¼ˆåŸå§‹å€¼ï¼‰
///
/// è¿”å›æœªç»è½¬æ¢çš„åŸå§‹æ•´æ•°å€¼
pub fn position_raw(&self) -> i32 {
    self.position_rad
}

/// è·å–ä½ç½®ï¼ˆradï¼‰âš ï¸ å•ä½æœªç¡®è®¤
///
/// **è­¦å‘Š**: æ­¤å‡½æ•°å‡è®¾å•ä½æ˜¯ radï¼Œä½†æœªç»éªŒè¯
#[deprecated(note = "å•ä½æœªç¡®è®¤ï¼Œè¯·è°¨æ…ä½¿ç”¨")]
pub fn position(&self) -> f64 {
    self.position_rad as f64
}
```

### æ–¹æ¡ˆ B: ä½¿ç”¨é…ç½®å‚æ•°

```rust
// åœ¨é…ç½®ä¸­æŒ‡å®šå•ä½
pub struct PositionConfig {
    pub unit: PositionUnit,
}

pub enum PositionUnit {
    Rad,
    Millirad,
    Degree_0_01,  // 0.01åº¦
    EncoderTicks { ratio: f64 },
}
```

---

## 6. ä»£ç ä½¿ç”¨æƒ…å†µè°ƒç ”ï¼ˆç¬¬5è½®ä¿®æ­£ï¼‰

### 6.1 è°ƒç ”æ–¹æ³•

**ç›®æ ‡**: ç¡®è®¤é™¤äº†æµ‹è¯•ä»£ç å¤–ï¼Œæ˜¯å¦æœ‰ç”Ÿäº§ä»£ç ä¾èµ– `position_rad` å­—æ®µ

**æœç´¢èŒƒå›´**:
```bash
# 1. æœç´¢æ‰€æœ‰ position_rad ä½¿ç”¨
grep -r "position_rad" crates/

# 2. æœç´¢æ‰€æœ‰ position() å’Œ position_deg() è°ƒç”¨
grep -r "\.position()\|position_deg()" crates/

# 3. æœç´¢ JointDriverHighSpeedFeedback ä½¿ç”¨
grep -r "JointDriverHighSpeedFeedback" crates/
```

---

### 6.2 è°ƒç ”ç»“æœ

#### æœ€ç»ˆéªŒè¯ï¼ˆç¬¬5è½®ç¬¬ä¸‰é˜¶æ®µï¼‰

**éªŒè¯ 1: åºåˆ—åŒ–é£é™©æ£€æŸ¥**

æ£€æŸ¥ `JointDriverHighSpeedFeedback` æ˜¯å¦æœ‰è‡ªå®šä¹‰ `Serialize` å®ç°è°ƒç”¨ `.position()`ï¼š

```rust
// crates/piper-protocol/src/feedback.rs
#[derive(Debug, Clone, Copy, Default)]  // âœ… NO Serialize trait
pub struct JointDriverHighSpeedFeedback {
    pub joint_index: u8,
    pub speed_rad_s: i16,
    pub current_a: i16,
    pub position_rad: i32,
}

// âœ… æœç´¢æ•´ä¸ªä»£ç åº“ï¼Œæ— è‡ªå®šä¹‰ Serialize å®ç°
```

âœ… **ç»“è®º**: æ— åºåˆ—åŒ–é£é™©

---

**éªŒè¯ 2: é«˜å±‚ API æ•°æ®æºè¿½è¸ª**

è¿½è¸ª `Observer::get_joint_position()` çš„æ•°æ®æ¥æºï¼š

```rust
// 1. Observer API (crates/piper-client/src/observer.rs)
impl PiperObserver {
    pub fn get_joint_position(&self, joint: Joint) -> Result<Rad> {
        let ctx = self.driver_ctx.load();
        let joint_pos = &ctx.joint_position;  // â† Arc<JointPositionState>
        Ok(Rad(joint_pos.joint_pos[joint.index()]))
    }
}

// 2. JointPositionState å®šä¹‰ (crates/piper-driver/src/state.rs)
pub struct JointPositionState {
    pub hardware_timestamp_us: u64,
    pub system_timestamp_us: u64,
    pub joint_pos: [f64; 6],  // â† å¼§åº¦ (Radians)
    pub frame_valid_mask: u8,
}

// 3. æ•°æ®æ¥æº (crates/piper-driver/src/pipeline.rs:798)
ctx.joint_position.store(Arc::new(new_joint_pos_state));
// new_joint_pos_state.joint_pos = state.pending_joint_pos

// 4. pending_joint_pos çš„èµ‹å€¼ (pipeline.rs:758-782)
ID_JOINT_FEEDBACK_12 => {
    if let Ok(feedback) = JointFeedback12::try_from(*frame) {
        state.pending_joint_pos[0] = feedback.j1_rad();  // âœ… å•ä½æ˜ç¡®
        state.pending_joint_pos[1] = feedback.j2_rad();  // âœ… å•ä½æ˜ç¡®
    }
}

ID_JOINT_FEEDBACK_34 => {
    if let Ok(feedback) = JointFeedback34::try_from(*frame) {
        state.pending_joint_pos[2] = feedback.j3_rad();  // âœ… å•ä½æ˜ç¡®
        state.pending_joint_pos[3] = feedback.j4_rad();  // âœ… å•ä½æ˜ç¡®
    }
}

ID_JOINT_FEEDBACK_56 => {
    if let Ok(feedback) = JointFeedback56::try_from(*frame) {
        state.pending_joint_pos[4] = feedback.j5_rad();  // âœ… å•ä½æ˜ç¡®
        state.pending_joint_pos[5] = feedback.j6_rad();  // âœ… å•ä½æ˜ç¡®
    }
}
```

âœ… **å…³é”®å‘ç°**:
- é«˜å±‚ API çš„æ•°æ®æ¥è‡ª `JointFeedback12/34/56` å¸§ç»„ï¼ˆCAN ID 0x2A5-0x2A7ï¼‰
- è¿™äº›å¸§çš„å•ä½æ˜¯ **æ˜ç¡®çš„** (`j1_rad()` ç­‰æ–¹æ³•ï¼Œä» 0.001Â° è½¬æ¢ä¸º radï¼‰
- **ä¸ `JointDriverHighSpeedFeedback` å®Œå…¨æ— å…³**ï¼ˆCAN ID 0x251-0x256ï¼‰
- ä¸¤å¥—ç‹¬ç«‹çš„ä½ç½®åé¦ˆç³»ç»Ÿï¼Œäº’ä¸å¹²æ‰°

---

#### å‘ç° 1: å®šä¹‰å±‚ (`piper-protocol/src/feedback.rs`)

**å…¬å¼€æ–¹æ³•**:
```rust
impl JointDriverHighSpeedFeedback {
    /// è·å–ä½ç½®åŸå§‹å€¼ï¼ˆrad å•ä½ï¼‰
    pub fn position_raw(&self) -> i32 {
        self.position_rad
    }

    /// è·å–ä½ç½®ï¼ˆradï¼‰
    pub fn position(&self) -> f64 {
        self.position_rad as f64
    }

    /// è·å–ä½ç½®ï¼ˆåº¦ï¼‰
    pub fn position_deg(&self) -> f64 {
        self.position() * 180.0 / std::f64::consts::PI
    }
}
```

**é—®é¢˜**:
- âŒ `position()` ç›´æ¥è½¬æ¢ `i32 -> f64`ï¼ˆæ— å•ä½è½¬æ¢ï¼‰
- âŒ `position_deg()` ä¾èµ– `position()`ï¼Œä¼šç»§æ‰¿é”™è¯¯
- âŒ å•ä½æ ‡æ³¨ä¸º `rad`ï¼Œä½†å¯èƒ½æ˜¯ `mrad` æˆ–å…¶ä»–ç¼–ç 

---

#### å‘ç° 2: Driver å±‚ (`piper-driver/src/pipeline.rs:874`)

**ç”Ÿäº§ä»£ç **:
```rust
if let Ok(feedback) = JointDriverHighSpeedFeedback::try_from(*frame) {
    // 1. æ›´æ–°ç¼“å†²åŒºï¼ˆè€Œä¸æ˜¯ç«‹å³æäº¤ï¼‰
    state.pending_joint_dynamic.joint_vel[joint_index] = feedback.speed();
    state.pending_joint_dynamic.joint_current[joint_index] = feedback.current();
    state.pending_joint_dynamic.timestamps[joint_index] = frame.timestamp_us;

    // 2. æ ‡è®°è¯¥å…³èŠ‚å·²æ›´æ–°
    state.vel_update_mask |= 1 << joint_index;
    // ...
}
```

**âœ… å…³é”®å‘ç°**:
- âœ… Driver å±‚**ä½¿ç”¨äº†** `JointDriverHighSpeedFeedback`
- âœ… ä½†**åªä½¿ç”¨äº†**: `speed()`, `current()`, `timestamp_us`
- âŒ **æ²¡æœ‰ä½¿ç”¨**: `position()`, `position_deg()`

---

#### å‘ç° 3: Client å±‚ (`piper-client`)

**æœç´¢ç»“æœ**:
```bash
$ grep -r "\.position()\|position_deg()" crates/piper-client/src/
# No matches found
```

âœ… **æ²¡æœ‰ä½¿ç”¨**

---

#### å‘ç° 4: SDK å±‚ (`piper-sdk`)

**æœç´¢ç»“æœ**:
```bash
$ grep -r "\.position()\|position_deg()" crates/piper-sdk/src/
# No matches found
```

âœ… **æ²¡æœ‰ä½¿ç”¨**

**æ³¨æ„**: æµ‹è¯•ä»£ç ä¸­ä½¿ç”¨çš„æ˜¯**é«˜å±‚ API** `piper.get_joint_position()`ï¼Œè€Œé `JointDriverHighSpeedFeedback::position()`

---

#### å‘ç° 5: åº”ç”¨å±‚ (`apps/cli`, `examples`)

**æœç´¢ç»“æœ**:
```bash
$ grep -r "\.position()\|position_deg()\|JointDriverHighSpeedFeedback" apps/
# No matches found

$ grep -r "\.position()\|position_deg()\|JointDriverHighSpeedFeedback" examples/
# No matches found
```

âœ… **æ²¡æœ‰ä½¿ç”¨**

---

#### å‘ç° 6: æµ‹è¯•å±‚

**å•å…ƒæµ‹è¯•** (`piper-protocol/src/feedback.rs`):
```rust
#[test]
fn test_joint_driver_high_speed_feedback_physical_conversion() {
    // æµ‹è¯•ç‰©ç†é‡è½¬æ¢
    let position_val = 3141592i32; // çº¦ Ï€ radï¼ˆå¦‚æœæŒ‰ 0.001rad å•ä½ï¼‰â“ çŸ›ç›¾ï¼

    assert_eq!(feedback.position(), position_val as f64);
    // âŒ åªéªŒè¯æ•°å€¼ç›¸ç­‰ï¼ŒæœªéªŒè¯ç‰©ç†æ„ä¹‰
}
```

**é›†æˆæµ‹è¯•** (`piper-sdk/tests/`):
- âœ… ä½¿ç”¨**é«˜å±‚ API** `piper.get_joint_position()`
- âŒ æ²¡æœ‰ç›´æ¥ä½¿ç”¨ `JointDriverHighSpeedFeedback::position()`

---

### 6.3 è°ƒç ”ç»“è®º

#### ä½¿ç”¨æƒ…å†µæ±‡æ€»è¡¨

| å±‚çº§ | æ˜¯å¦ä½¿ç”¨ `position()` | ä½¿ç”¨æ–¹æ³• | å½±å“ |
|------|---------------------|----------|------|
| **åè®®å±‚** (piper-protocol) | âœ… å®šä¹‰ | `position()`, `position_deg()` | - |
| **é©±åŠ¨å±‚** (piper-driver) | âŒ å¦ | ä»… `speed()`, `current()` | æ— å½±å“ |
| **å®¢æˆ·ç«¯** (piper-client) | âŒ å¦ | - | æ— å½±å“ |
| **SDK** (piper-sdk) | âŒ å¦ | ä½¿ç”¨é«˜å±‚ API | æ— å½±å“ |
| **åº”ç”¨å±‚** (apps/cli) | âŒ å¦ | - | æ— å½±å“ |
| **ç¤ºä¾‹** (examples) | âŒ å¦ | - | æ— å½±å“ |
| **æµ‹è¯•** (tests) | âš ï¸ å•å…ƒæµ‹è¯• | ä»…éªŒè¯å­—èŠ‚è§£æ | æ— å½±å“ |

#### å…³é”®å‘ç°

1. **âœ… å¥½æ¶ˆæ¯**: **æ²¡æœ‰ç”Ÿäº§ä»£ç ä¾èµ–** `position()` æˆ– `position_deg()`
2. **âœ… Driver å±‚**: ä»…ä½¿ç”¨ `speed()` å’Œ `current()`ï¼Œè¿™ä¸¤ä¸ªå­—æ®µçš„å•ä½æ˜¯**æ˜ç¡®çš„**ï¼ˆ0.001rad/s, 0.001Aï¼‰
3. **âœ… æµ‹è¯•ä»£ç **: ä½¿ç”¨é«˜å±‚ APIï¼Œä¸å—å½±å“
4. **ğŸŸ¡ åè®®å±‚**: `position()` æ–¹æ³•å­˜åœ¨ä½†æœªä½¿ç”¨ï¼Œæ˜¯"æ­»ä»£ç "ï¼ˆDead Codeï¼‰

#### é£é™©è¯„ä¼°ä¿®æ­£

**åŸæŠ¥å‘Šé£é™©è¯„ä¼°**:
- ğŸ”´ **æé«˜**: å¯èƒ½å¯¼è‡´ 1000 å€è¯¯å·®
- ğŸ”´ **æé«˜**: æœºå™¨äººç§»åŠ¨åˆ°é”™è¯¯ä½ç½®
- ğŸ”´ **æé«˜**: è½¨è¿¹å®Œå…¨é”™è¯¯

**ä¿®æ­£åé£é™©è¯„ä¼°**:
- ğŸŸ¢ **ä½**: **ä»…å½±å“åè®®å±‚æœªä½¿ç”¨çš„å…¬å¼€æ–¹æ³•**
- ğŸŸ¢ **ä½**: **ä¸å½±å“ä»»ä½•åŠŸèƒ½**
- ğŸŸ¡ **ä¸­**: å¦‚æœæœªæ¥ä»£ç ä½¿ç”¨ `position()`ï¼Œå¯èƒ½å¼•å…¥é”™è¯¯

---

### 6.4 ä¿®æ­£åçš„å»ºè®®

#### ç«‹å³è¡ŒåŠ¨ï¼ˆæ— éœ€ä¿®æ”¹ï¼‰

**âœ… å¯ä»¥ç»§ç»­ä½¿ç”¨å½“å‰ä»£ç **
- æ²¡æœ‰ç”Ÿäº§ä»£ç ä¾èµ– `position()`
- ä¸ä¼šå½±å“å½“å‰åŠŸèƒ½
- é£é™©ç­‰çº§ï¼šğŸŸ¢ ä½

#### çŸ­æœŸè¡ŒåŠ¨ï¼ˆP2ï¼Œ0.2.0ï¼‰

**å»ºè®® 1: æ ‡è®°ä¸º Deprecated**

```rust
impl JointDriverHighSpeedFeedback {
    /// è·å–ä½ç½®ï¼ˆradï¼‰
    ///
    /// # âš ï¸ å¼ƒç”¨è­¦å‘Š (Deprecated)
    ///
    /// **æ­¤æ–¹æ³•çš„è¿”å›å€¼å•ä½æœªç¡®è®¤**ï¼Œå¯èƒ½å¯¼è‡´ä¸æ­£ç¡®çš„ä½ç½®å€¼ã€‚
    ///
    /// **å·²çŸ¥é—®é¢˜**:
    /// - å­—æ®µæ ‡æ³¨ä¸º `rad`ï¼Œä½†æµ‹è¯•æ•°æ®å­˜åœ¨çŸ›ç›¾ï¼ˆ3141592 å¯¹åº” Ï€ï¼Ÿï¼‰
    /// - å¯èƒ½çš„å•ä½ï¼šradã€mradï¼ˆ0.001radï¼‰ã€0.01Â°ã€ç¼–ç å™¨ ticks
    /// - å½“å‰**æ²¡æœ‰ç”Ÿäº§ä»£ç ä½¿ç”¨æ­¤æ–¹æ³•**
    ///
    /// **æ›¿ä»£æ–¹æ¡ˆ**:
    /// - é«˜å±‚ API: `piper.observer().get_joint_position(joint)` - æ¨èï¼Œå•ä½å·²ç¡®è®¤ä¸ºå¼§åº¦
    /// - åè®®å±‚: `JointFeedback12::j1_rad()`, `j2_rad()` ç­‰ - å•ä½æ˜ç¡® (ä» 0.001Â° è½¬æ¢)
    /// - åŸå§‹å€¼: `self.position_raw()` - è·å–æœªè½¬æ¢çš„ i32 åŸå§‹å€¼
    ///
    /// **èƒŒæ™¯**: è¯¦è§ `docs/v0/position_unit_analysis_report.md`
    #[deprecated(
        since = "0.1.0",
        note = "Field unit unverified (rad vs mrad). Prefer `Observer::get_joint_position()` for verified position data, or use `position_raw()` for raw access."
    )]
    pub fn position(&self) -> f64 {
        self.position_rad as f64
    }

    /// è·å–ä½ç½®ï¼ˆåº¦ï¼‰
    ///
    /// # âš ï¸ å¼ƒç”¨è­¦å‘Š (Deprecated)
    ///
    /// æ­¤æ–¹æ³•ä¾èµ–äº `position()`ï¼Œç»§æ‰¿äº†ç›¸åŒçš„å•ä½é—®é¢˜ã€‚
    ///
    /// **æ›¿ä»£æ–¹æ¡ˆ**:
    /// - é«˜å±‚ API: `piper.observer().get_joint_position(joint)` è¿”å›å¼§åº¦ï¼Œå¯è½¬æ¢ä¸ºåº¦
    /// - åè®®å±‚: `JointFeedback12::j1_deg()`, `j2_deg()` ç­‰ - å•ä½æ˜ç¡® (0.001Â°)
    #[deprecated(
        since = "0.1.0",
        note = "Depends on unverified `position()`. Prefer `Observer::get_joint_position()` or `JointFeedback12::j1_deg()` for verified degree data."
    )]
    pub fn position_deg(&self) -> f64 {
        self.position() * 180.0 / std::f64::consts::PI
    }
}
```

**å»ºè®® 2: æ›´æ–°æ–‡æ¡£**

åœ¨ `JointDriverHighSpeedFeedback` çš„æ–‡æ¡£ä¸­æ·»åŠ ï¼š

```rust
/// é«˜é€Ÿå…³èŠ‚é©±åŠ¨åé¦ˆï¼ˆCAN ID: 0x251-0x256ï¼‰
///
/// # âš ï¸ ä½ç½®å­—æ®µè­¦å‘Š
///
/// **`position_rad` å­—æ®µçš„å•ä½æœªç¡®è®¤**ï¼Œå¯èƒ½å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š
/// - å­—æ®µæ ‡æ³¨ä¸º `rad`ï¼ˆå¼§åº¦ï¼‰
/// - ä½†æµ‹è¯•æ•°æ® `3141592` çš„è§£é‡Šå­˜åœ¨çŸ›ç›¾
/// - å®é™…å•ä½å¯èƒ½æ˜¯ï¼šradã€mradã€0.01Â°ã€ç¼–ç å™¨ ticks
///
/// **å»ºè®®**:
/// - âŒ **ä¸è¦ä½¿ç”¨**: `position()`, `position_deg()` æ–¹æ³•ï¼ˆå•ä½æœªç¡®è®¤ï¼‰
/// - âœ… **æ¨èä½¿ç”¨**: `Observer::get_joint_position()` (é«˜å±‚æŠ½è±¡ï¼Œå•ä½å·²ç¡®è®¤)
/// - âœ… **å¦‚éœ€è¦åŸå§‹å€¼**: ä½¿ç”¨ `position_raw()` å¹¶è‡ªè¡Œè½¬æ¢å•ä½
///
/// **èƒŒæ™¯**: è¯¦è§ `docs/v0/position_unit_analysis_report.md`
pub struct JointDriverHighSpeedFeedback {
    // ...
}
```

---

## 7. æ€»ç»“ï¼ˆä»£ç è°ƒç ”ä¿®æ­£ç‰ˆï¼‰

### 7.1 é—®é¢˜ä¸¥é‡æ€§ï¼ˆä¿®æ­£ï¼‰

| é—®é¢˜ | åŸè¯„ä¼° | ä¿®æ­£å | ç†ç”± |
|------|--------|--------|------|
| å•ä½æœªç¡®è®¤ | ğŸ”´ æé«˜ | ğŸŸ¡ **ä¸­** | **æ— ç”Ÿäº§ä»£ç ä½¿ç”¨** |
| æµ‹è¯•æœªéªŒè¯ç‰©ç†æ„ä¹‰ | ğŸ”´ é«˜ | ğŸŸ¢ **ä½** | ä»…éªŒè¯å­—èŠ‚è§£æ |
| å¯èƒ½çš„1000å€è¯¯å·® | ğŸ”´ æé«˜ | ğŸŸ¢ **ä½** | ä¸å½±å“å½“å‰åŠŸèƒ½ |
| **æ­»ä»£ç é£é™©** | âŒ æœªæåŠ | ğŸŸ¡ **ä¸­** | `position()` æ–¹æ³•å­˜åœ¨ä½†æœªä½¿ç”¨ |

---

### 7.2 ç«‹å³è¡ŒåŠ¨é¡¹ï¼ˆä¿®æ­£ï¼‰

#### âœ… æ— éœ€ç«‹å³è¡ŒåŠ¨

**åŸå› **:
- âœ… æ²¡æœ‰ç”Ÿäº§ä»£ç ä¾èµ– `position()` æˆ– `position_deg()`
- âœ… Driver å±‚ä»…ä½¿ç”¨ `speed()` å’Œ `current()`ï¼ˆå•ä½æ˜ç¡®ï¼‰
- âœ… æ‰€æœ‰åŠŸèƒ½ä½¿ç”¨é«˜å±‚ APIï¼Œä¸å—å½±å“
- âœ… å½“å‰ä»£ç **å®‰å…¨å¯ç”¨**

#### ğŸŸ¡ P2 - çŸ­æœŸï¼ˆ0.2.0ï¼‰

**ä»»åŠ¡ 1: æ·»åŠ  Deprecated æ ‡è®°**

```rust
#[deprecated(
    since = "0.1.0",
    note = "å•ä½æœªç¡®è®¤ï¼Œå¯èƒ½å¯¼è‡´ 1000 å€è¯¯å·®ã€‚ä½¿ç”¨ Observer::get_joint_position() æ›¿ä»£"
)]
pub fn position(&self) -> f64 {
    self.position_rad as f64
}
```

**å·¥ä½œé‡**: 10 åˆ†é’Ÿ

---

**ä»»åŠ¡ 2: æ›´æ–°æ–‡æ¡£**

åœ¨ `JointDriverHighSpeedFeedback` æ–‡æ¡£ä¸­æ·»åŠ è­¦å‘Šã€‚

**å·¥ä½œé‡**: 15 åˆ†é’Ÿ

---

#### âŒ ä¸éœ€è¦

**è”ç³»ç¡¬ä»¶å‚å•†** - **ä¸éœ€è¦**ï¼ŒåŸå› ï¼š
- âœ… æ²¡æœ‰ç”Ÿäº§ä»£ç ä½¿ç”¨æ­¤æ–¹æ³•
- âœ… ä¸å½±å“å½“å‰åŠŸèƒ½
- âœ… å¯ä»¥åœ¨æœªæ¥éœ€è¦æ—¶å†ç¡®è®¤

**æ·»åŠ å•ä½éªŒè¯æµ‹è¯•** - **ä¸éœ€è¦**ï¼ŒåŸå› ï¼š
- âœ… å½“å‰æ— ä½¿ç”¨åœºæ™¯
- âœ… æµ‹è¯•éœ€è¦ç¡¬ä»¶è¿æ¥
- âœ… å¯ä»¥åœ¨æ ‡è®° Deprecated åå†å†³å®š

---

### 7.3 é£é™©è¯„ä¼°ï¼ˆæœ€ç»ˆç‰ˆï¼‰

| é£é™© | ç­‰çº§ | è§¦å‘æ¡ä»¶ | ç¼“è§£æªæ–½ |
|------|------|----------|----------|
| **æœªæ¥ä»£ç è¯¯ç”¨ `position()`** | ğŸŸ¡ ä¸­ | æ–°ä»£ç ä½¿ç”¨æ­¤æ–¹æ³• | âœ… æ ‡è®° Deprecated |
| **å½“å‰åŠŸèƒ½å—å½±å“** | ğŸŸ¢ **ä½** | æ—  | âœ… æ— å½±å“ |
| **æœºå™¨äººå¤±æ§é£é™©** | ğŸŸ¢ **ä½** | æ—  | âœ… æ— å½±å“ |

---

### 7.4 å…³é”®æ•™è®­

1. **ä»£ç è°ƒç ”çš„é‡è¦æ€§**
   - ä¸èƒ½ä»…å‡­å­—æ®µå®šä¹‰åˆ¤æ–­é£é™©
   - å¿…é¡»éªŒè¯**å®é™…ä½¿ç”¨æƒ…å†µ**
   - æœªä½¿ç”¨çš„ä»£ç é£é™©è¿œä½äºä½¿ç”¨ä¸­çš„ä»£ç 

2. **åˆ†å±‚æ¶æ„çš„ä¿æŠ¤ä½œç”¨**
   - Driver å±‚**æœªä½¿ç”¨** `position()`ï¼Œä¿æŠ¤äº†ä¸Šå±‚ä»£ç 
   - é«˜å±‚ API `get_joint_position()` æä¾›äº†å®‰å…¨æŠ½è±¡
   - åè®®å±‚çš„"é—®é¢˜ä»£ç "è¢«éš”ç¦»åœ¨åº•å±‚

3. **æ­»ä»£ç ï¼ˆDead Codeï¼‰çš„ä»·å€¼**
   - `position()` æ˜¯**æ­»ä»£ç **ï¼ˆå®šä¹‰äº†ä½†æœªä½¿ç”¨ï¼‰
   - æ­»ä»£ç çš„é£é™©è¿œä½äºæ´»è·ƒä»£ç 
   - å¯ä»¥é€šè¿‡ Deprecated æ ‡è®°é€æ­¥æ¸…ç†

---

### 7.5 ä¿®æ­£åçš„ä¼˜å…ˆçº§

| ä¼˜å…ˆçº§ | ä»»åŠ¡ | æ—¶é—´ | ç†ç”± |
|--------|------|------|------|
| **âœ… æ— éœ€** | è”ç³»ç¡¬ä»¶å‚å•† | - | æ— ç”Ÿäº§ä»£ç ä½¿ç”¨ |
| **âœ… æ— éœ€** | æ·»åŠ å•ä½éªŒè¯æµ‹è¯• | - | ä¸å½±å“å½“å‰åŠŸèƒ½ |
| **ğŸŸ¡ P2** | æ ‡è®° Deprecated | 10åˆ†é’Ÿ | é˜²æ­¢æœªæ¥è¯¯ç”¨ |
| **ğŸŸ¡ P2** | æ›´æ–°æ–‡æ¡£ | 15åˆ†é’Ÿ | è®°å½•å·²çŸ¥é—®é¢˜ |

---

**æŠ¥å‘Šç”Ÿæˆ**: 2026-01-27 (v5.2 - æœ€ç»ˆéªŒè¯ç‰ˆ)
**å®¡æŸ¥äººå‘˜**: AI Code Auditor
**ä¸“å®¶åé¦ˆ**: æ„Ÿè°¢å…³äºä»£ç ä½¿ç”¨æƒ…å†µçš„ç²¾å‡†æŒ‡æ­£ï¼Œè°ƒç ”åå‘ç°**æ— ç”Ÿäº§ä»£ç ä¾èµ–**

**å…³é”®ä¿®æ­£**:
- âœ… ä»"ğŸ”´ æé«˜é£é™©"ä¿®æ­£ä¸º"ğŸŸ¢ ä½é£é™©"
- âœ… ä»"å¿…é¡»ç«‹å³ä¿®å¤"ä¿®æ­£ä¸º"P2 ä¼˜åŒ–"
- âœ… æ·»åŠ å®Œæ•´çš„ä»£ç ä½¿ç”¨æƒ…å†µè°ƒç ”ï¼ˆç¬¬6èŠ‚ï¼‰
- âœ… æœ€ç»ˆéªŒè¯ï¼šåºåˆ—åŒ–æ£€æŸ¥ + æ•°æ®æºè¿½è¸ª

---

## 8. æœ€ç»ˆéªŒè¯ç»“è®ºï¼ˆç¬¬5è½®ç¬¬ä¸‰é˜¶æ®µï¼‰

### 8.1 å®Œæ•´éªŒè¯æ¸…å•

| éªŒè¯é¡¹ | æ–¹æ³• | ç»“æœ | çŠ¶æ€ |
|--------|------|------|------|
| **ç”Ÿäº§ä»£ç ä¾èµ–** | Grep å…¨ä»£ç åº“æœç´¢ | âœ… æ— ä½¿ç”¨ | é€šè¿‡ |
| **æµ‹è¯•ä»£ç ä¾èµ–** | Grep tests/ ç›®å½• | âœ… ä»…å­—èŠ‚è§£ææµ‹è¯• | é€šè¿‡ |
| **åºåˆ—åŒ–é£é™©** | æ£€æŸ¥ `Serialize` trait | âœ… æ—  derive/impl | é€šè¿‡ |
| **é«˜å±‚ API æ•°æ®æº** | è¿½è¸ªè°ƒç”¨é“¾ | âœ… æ¥è‡ª `JointFeedback*` | é€šè¿‡ |
| **å•ä½ç¡®è®¤** | éªŒè¯æ•°æ®è·¯å¾„ | âœ… é«˜å±‚ API å•ä½æ˜ç¡® | é€šè¿‡ |

---

### 8.2 æ•°æ®æµæ¶æ„åˆ†æ

**ä¸¤å¥—ç‹¬ç«‹çš„ä½ç½®åé¦ˆç³»ç»Ÿ**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    é«˜å±‚ä½ç½®æ•°æ®æµï¼ˆâœ… å•ä½æ˜ç¡®ï¼‰              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ JointFeedback12/34/56 (0x2A5-0x2A7)                         â”‚
â”‚   â”œâ”€ j1_rad() â†’ å¼§åº¦ï¼ˆä» 0.001Â° è½¬æ¢ï¼‰                      â”‚
â”‚   â”œâ”€ j2_rad() â†’ å¼§åº¦ï¼ˆä» 0.001Â° è½¬æ¢ï¼‰                      â”‚
â”‚   â””â”€ ... â†’ pending_joint_pos â†’ joint_position              â”‚
â”‚       â””â”€ Observer::get_joint_position() â† ç”¨æˆ·ä½¿ç”¨           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä½å±‚ä½ç½®æ•°æ®æµï¼ˆâ“ å•ä½æœªç¡®è®¤ï¼‰            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ JointDriverHighSpeedFeedback (0x251-0x256)                  â”‚
â”‚   â”œâ”€ position()    â†’ âŒ å•ä½æœªç¡®è®¤ï¼ˆæœªä½¿ç”¨ï¼‰                 â”‚
â”‚   â”œâ”€ position_deg()â†’ âŒ ä¾èµ– position()ï¼ˆæœªä½¿ç”¨ï¼‰            â”‚
â”‚   â”œâ”€ speed()       â†’ âœ… å•ä½æ˜ç¡® 0.001rad/sï¼ˆå·²ä½¿ç”¨ï¼‰        â”‚
â”‚   â””â”€ current()     â†’ âœ… å•ä½æ˜ç¡® 0.001Aï¼ˆå·²ä½¿ç”¨ï¼‰            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®å‘ç°**:
- é«˜å±‚ API çš„æ•°æ®æ¥è‡ª `JointFeedback*`ï¼ˆå•ä½æ˜ç¡®ï¼‰
- `JointDriverHighSpeedFeedback::position()` æœªè¢«ä½¿ç”¨ï¼Œæ˜¯æ­»ä»£ç 
- ä¸¤å¥—ç³»ç»Ÿäº’ä¸å¹²æ‰°ï¼Œéš”ç¦»è‰¯å¥½

---

### 8.3 åŸºäºè¯æ®çš„é™çº§ (Evidence-based De-escalation)

| ç»´åº¦ | ç†è®ºé£é™© | å®é™…é£é™© | é™çº§ç†ç”± |
|------|----------|----------|----------|
| **ä»£ç ä½¿ç”¨** | å¯èƒ½è¢«è¯¯ç”¨ | ğŸŸ¢ æ— ä½¿ç”¨ | Grep æœç´¢éªŒè¯ |
| **åºåˆ—åŒ–** | å¯èƒ½éšè—ä½¿ç”¨ | ğŸŸ¢ æ— å®ç° | æ£€æŸ¥ derive/impl |
| **æ•°æ®æ±¡æŸ“** | å¯èƒ½å½±å“é«˜å±‚ | ğŸŸ¢ å®Œå…¨éš”ç¦» | ç‹¬ç«‹æ•°æ®æº |
| **åŠŸèƒ½å½±å“** | å¯èƒ½å¯¼è‡´å¤±æ§ | ğŸŸ¢ æ— å½±å“ | æ­»ä»£ç  |
| **ä¼˜å…ˆçº§** | ğŸ”´ P0 ç´§æ€¥ | ğŸŸ¡ P2 ä¼˜åŒ– | ç»¼åˆè¯„ä¼° |

---

### 8.4 æœ€ç»ˆè¡ŒåŠ¨å»ºè®®

| ä¼˜å…ˆçº§ | ä»»åŠ¡ | å·¥ä½œé‡ | æˆªæ­¢ç‰ˆæœ¬ |
|--------|------|--------|----------|
| **ğŸŸ¡ P2** | æ ‡è®° `position()` ä¸º `#[deprecated]` | 10 åˆ†é’Ÿ | 0.2.0 |
| **ğŸŸ¡ P2** | æ ‡è®° `position_deg()` ä¸º `#[deprecated]` | 5 åˆ†é’Ÿ | 0.2.0 |
| **ğŸŸ¡ P2** | æ›´æ–° `JointDriverHighSpeedFeedback` æ–‡æ¡£ | 15 åˆ†é’Ÿ | 0.2.0 |
| **âœ… æ— éœ€** | è”ç³»ç¡¬ä»¶å‚å•†ç¡®è®¤å•ä½ | - | - |
| **âœ… æ— éœ€** | æ·»åŠ å•ä½éªŒè¯æµ‹è¯• | - | - |
| **âœ… æ— éœ€** | ä¿®æ”¹å½“å‰ç”Ÿäº§ä»£ç  | - | - |

---

### 8.5 å…³é”®æ•™è®­

1. **ä»£ç è°ƒç ”çš„é‡è¦æ€§**
   - âœ… ç†è®ºåˆ†æ â‰  å®é™…é£é™©
   - âœ… å¿…é¡»éªŒè¯**å®é™…ä½¿ç”¨æƒ…å†µ**
   - âœ… æœªä½¿ç”¨çš„ä»£ç é£é™©è¿œä½äºæ´»è·ƒä»£ç 

2. **åˆ†å±‚æ¶æ„çš„ä¿æŠ¤ä½œç”¨**
   - âœ… Driver å±‚**æœªä½¿ç”¨** `position()`ï¼Œä¿æŠ¤äº†ä¸Šå±‚
   - âœ… é«˜å±‚ API æä¾›äº†å®‰å…¨æŠ½è±¡
   - âœ… åè®®å±‚çš„"é—®é¢˜ä»£ç "è¢«éš”ç¦»åœ¨åº•å±‚

3. **æ•°æ®æºè¿½è¸ªçš„ä»·å€¼**
   - âœ… è¿½è¸ª `Observer::get_joint_position()` å‘ç°ç‹¬ç«‹æ•°æ®æº
   - âœ… ä¸¤å¥—ä½ç½®åé¦ˆç³»ç»Ÿå®Œå…¨éš”ç¦»
   - âœ… é«˜å±‚ API ä½¿ç”¨çš„æ˜¯å•ä½æ˜ç¡®çš„æ•°æ®æº

4. **è¯æ®ä¼˜å…ˆåŸåˆ™**
   - âœ… Grep æœç´¢ > ç†è®ºæ¨æµ‹
   - âœ… å®é™…ä»£ç  > å¯èƒ½æ€§åˆ†æ
   - âœ… æ­»ä»£ç é£é™©è¯„ä¼° â‰  æ´»è·ƒä»£ç 

---

### 8.6 é™çº§ç¡®è®¤

**åŸå§‹é£é™©è¯„ä¼°** (v1.0):
- ğŸ”´ **P0 - æé«˜é£é™©**: å¯èƒ½å¯¼è‡´ 1000 å€è¯¯å·®
- ğŸ”´ **P0 - ç´§æ€¥**: å¿…é¡»ç«‹å³ä¿®å¤
- ğŸ”´ **P0 - å®‰å…¨å…³é”®**: å¯èƒ½å¯¼è‡´æœºå™¨äººå¤±æ§

**æœ€ç»ˆé£é™©è¯„ä¼°** (v5.2):
- ğŸŸ¢ **ä½é£é™©**: æ— ç”Ÿäº§ä»£ç ä½¿ç”¨ï¼Œå®Œå…¨éš”ç¦»çš„æ­»ä»£ç 
- ğŸŸ¡ **P2 - ä¼˜åŒ–**: æ ‡è®°ä¸º Deprecatedï¼Œé˜²æ­¢æœªæ¥è¯¯ç”¨
- âœ… **å®‰å…¨å¯ç”¨**: å½“å‰ä»£ç å¯ä»¥å®‰å…¨ä½¿ç”¨ï¼Œæ— éœ€ç«‹å³ä¿®å¤

---

**æœ€ç»ˆç»“è®º**: **å½“å‰ä»£ç å¯ä»¥å®‰å…¨ä½¿ç”¨ï¼Œæ— éœ€ç«‹å³ä¿®å¤** ğŸ‰

è¿™æ˜¯ä¸€æ¬¡æˆåŠŸçš„ **"åŸºäºè¯æ®çš„é™çº§"** (Evidence-based De-escalation)ï¼š
- é€šè¿‡å…¨é¢çš„ä»£ç è°ƒç ”å’ŒéªŒè¯
- ä»ç†è®ºé£é™©é™çº§ä¸ºå®é™…é£é™©
- ä» P0 ç´§æ€¥é™çº§ä¸º P2 ä¼˜åŒ–
- èŠ‚çœäº†ä¸å¿…è¦çš„ç´§æ€¥ä¿®å¤æ—¶é—´

---

**ç‰¹åˆ«è‡´è°¢**: æ„Ÿè°¢ä¸“å®¶çš„ä¸‰é˜¶æ®µåé¦ˆ
1. ç¬¬ä¸€é˜¶æ®µï¼šæŒ‡å‡ºä»£ç è°ƒç ”ç›²ç‚¹
2. ç¬¬äºŒé˜¶æ®µï¼šå¼ºè°ƒå·¥ç¨‹å¯è¡Œæ€§
3. ç¬¬ä¸‰é˜¶æ®µï¼šè¦æ±‚æœ€ç»ˆéªŒè¯ï¼ˆåºåˆ—åŒ– + æ•°æ®æºï¼‰

è¿™ä¸‰ä¸ªé˜¶æ®µçš„åé¦ˆè®©è¿™ä»½æŠ¥å‘Šä»"ç†è®ºåˆ†æ"æå‡åˆ°äº†"**åŸºäºå®è¯çš„å·¥ç¨‹çº§æŒ‡å—**"ã€‚
