# PiPER 机械臂通讯协议 (AGX Protocol — Outside)

## 1. 协议基础信息

* **通讯标准**：CAN2.0B 标准帧格式
* **CAN 波特率**：1000K (1Mbps)
* **数据格式**：Motorola (MSB) 高位在前
* **版本说明**：基于 V1.5-2 版本后的改动在文中会注明（原文档绿色字体部分）。

---

## 2. 指令 ID 列表概览与节点定义

### 2.1 机械臂主动反馈指令

* **ID 范围**：`0x2A1` ~ `0x2A8`
* **发送节点**：机械臂主控
* **接收节点**：决策控制单元
* **备注**：可设置整体偏移为 0x2B1~0x2B8 或 0x2C1~0x2C8，详见指令 0x470。

### 2.2 机械臂运动控制指令

* **ID 范围**：`0x150` ~ `0x15F`
* **发送节点**：决策控制单元
* **接收节点**：机械臂主控
* **备注**：可设置整体偏移为 0x160~0x16F 或 0x170~0x17F，详见指令 0x470。

### 2.3 机械臂参数配置与设定指令

* **ID 范围**：`0x470` ~ `0x47C`
* **若指令名称带有“查询”、“设置”**：发送节点（决策控制单元） -> 接收节点（机械臂主控）
* **若指令名称带有“反馈”、“应答”**：发送节点（机械臂主控） -> 接收节点（决策控制单元）

### 2.4 关节电机驱动器信息反馈

* **ID 范围**：`0x251` ~ `0x256` (高速反馈) / `0x261` ~ `0x266` (低速反馈)
* **发送节点**：机械臂主控
* **接收节点**：决策控制单元

### 2.5 固件升级与其它

* **ID 范围**：`0x0A0~0x0AF`, `0x0B0~0x0BF`, `0x4A0~0x4AF`, `0x4B0~0x4BF`, `0x4C0~0x4CF`
* **说明**：机械臂固件升级指令ID覆盖范围，用户不需要关心，不给出详细协议。


* **ID 0x422**：固件升级模式设定指令。

---

## 3. CAN 指令简易控制流程 (官方教程)

1. 连接电源与 CAN 总线，机械臂上电。
2. 发送 `0x471` 指令使能全部关节电机：`id:0x471 byte0=7, byte1=2, byte2~byte7=0`。
3. 发送 `0x151` 指令进入 CAN 控制模式：`id:0x151 byte0=1, byte1~byte7=0`。
4. **关节模式运动**：发送 `0x155`、`0x156`、`0x157` 指令更新目标关节角度，发送 `0x151` 进入 **MOVE J** 模式并设置运动速度百分比即可。
5. **点位模式运动**：发送 `0x152`、`0x153`、`0x154` 指令更新目标点位姿，发送 `0x151` 进入 **MOVE P** 模式并设置运动速度百分比即可。
6. **直线模式运动**：依次发送 `0x152`、`0x153`、`0x154` 指令更新目标点位姿，发送 `0x151` 进入 **MOVE L** 模式并设置运动速度百分比即可。
7. **圆弧模式运动**：发送 `0x152`、`0x153`、`0x154` 指令更新起点位姿后发送 `0x158` 标记为起点，同理更新中点、终点位姿并标记，最后发送 `0x151` 进入 **MOVE C** 模式并设置运动速度百分比即可。(运动结束再次依照 4/5/6/7 流程发送对应指令即可运动到下一个目标点)。
8. **应急处理**：在运动过程中可发送 `id:0x150 byte0=1` 进行快速急停；急停状态全部关节电机进入阻尼模式(由于没有关节抱闸，机械臂会缓慢下落)，发送 `id:0x150 byte0=2` 退出关节阻尼模式，急停恢复后需要重新发送 `0x471` 指令使能电机方可继续运动。

---

## 4. 详细协议内容：机械臂状态反馈

### ID: 0x2A1 机械臂状态反馈 (Len: 8)

* **Byte 0: 控制模式 (uint8)**
* 0x00: 待机模式
* 0x01: CAN指令控制模式
* 0x02: 示教模式
* 0x03: 以太网控制模式
* 0x04: wifi控制模式
* 0x05: 遥控器控制模式
* 0x06: 联动示教输入模式
* 0x07: 离线轨迹模式


* **Byte 1: 机械臂状态 (uint8)**
* 0x00: 正常
* 0x01: 急停
* 0x02: 无解
* 0x03: 奇异点
* 0x04: 目标角度超过限
* 0x05: 关节通信异常
* 0x06: 关节抱闸未打开
* 0x07: 机械臂发生碰撞
* 0x08: 拖动示教时超速
* 0x09: 关节状态异常
* 0x0A: 其它异常
* 0x0B: 示教记录
* 0x0C: 示教执行
* 0x0D: 示教暂停
* 0x0E: 主控NTC过温
* 0x0F: 释放电阻NTC过温


* **Byte 2: 模式反馈 (uint8)**
* 0x00: MOVE P
* 0x01: MOVE J
* 0x02: MOVE L
* 0x03: MOVE C
* 0x04: MOVE M


* **Byte 3: 示教状态 (uint8)**
* 0x00: 关闭
* 0x01: 开始示教记录（进入拖动示教模式）
* 0x02: 结束示教记录（退出拖动示教模式）
* 0x03: 执行示教轨迹（拖动示教轨迹复现）
* 0x04: 暂停执行
* 0x05: 继续执行（轨迹复现继续）
* 0x06: 终止执行
* 0x07: 运动到轨迹起点


* **Byte 4: 运动状态 (uint8)**
* 0x00: 到达指定点位
* 0x01: 未到达指定点位


* **Byte 5: 当前运行轨迹点序号 (uint8_t)**
* 0~255 (离线轨迹模式下反馈)


* **Byte 6: 故障码 (uint8) - 详见下表**
* Bit 0: 1号关节角度超限位（0：正常 1：异常）
* Bit 1: 2号关节角度超限位（0：正常 1：异常）
* Bit 2: 3号关节角度超限位（0：正常 1：异常）
* Bit 3: 4号关节角度超限位（0：正常 1：异常）
* Bit 4: 5号关节角度超限位（0：正常 1：异常）
* Bit 5: 6号关节角度超限位（0：正常 1：异常）
* Bit 6-7: 保留


* **Byte 7: 故障码 (uint8) - 详见下表**
* Bit 0: 1号关节通信异常（0：正常 1：异常）
* Bit 1: 2号关节通信异常（0：正常 1：异常）
* Bit 2: 3号关节通信异常（0：正常 1：异常）
* Bit 3: 4号关节通信异常（0：正常 1：异常）
* Bit 4: 5号关节通信异常（0：正常 1：异常）
* Bit 5: 6号关节通信异常（0：正常 1：异常）
* Bit 6-7: 保留



### ID: 0x2A2 机械臂末端位姿反馈1 (Len: 8)

* **Byte 0**: X坐标最高位 (int32, 单位 0.001mm)
* **Byte 1**: X坐标次高位
* **Byte 2**: X坐标次低位
* **Byte 3**: X坐标最低位
* **Byte 4**: Y坐标最高位 (int32, 单位 0.001mm)
* **Byte 5**: Y坐标次高位
* **Byte 6**: Y坐标次低位
* **Byte 7**: Y坐标最低位

### ID: 0x2A3 机械臂末端位姿反馈2 (Len: 8)

* **Byte 0**: Z坐标最高位 (int32, 单位 0.001mm)
* **Byte 1**: Z坐标次高位
* **Byte 2**: Z坐标次低位
* **Byte 3**: Z坐标最低位
* **Byte 4**: RX角度最高位 (int32, 单位 0.001°)
* **Byte 5**: RX角度次高位
* **Byte 6**: RX角度次低位
* **Byte 7**: RX角度最低位

### ID: 0x2A4 机械臂末端位姿反馈3 (Len: 8)

* **Byte 0**: RY角度最高位 (int32, 单位 0.001°)
* **Byte 1**: RY角度次高位
* **Byte 2**: RY角度次低位
* **Byte 3**: RY角度最低位
* **Byte 4**: RZ角度最高位 (int32, 单位 0.001°)
* **Byte 5**: RZ角度次高位
* **Byte 6**: RZ角度次低位
* **Byte 7**: RZ角度最低位

### ID: 0x2A5 机械臂臂部关节反馈12 (Len: 8)

* **Byte 0-3**: J1角度 (int32, 单位 0.001°, 分为最高位/次高位/次低位/最低位)
* **Byte 4-7**: J2角度 (int32, 单位 0.001°, 分为最高位/次高位/次低位/最低位)

### ID: 0x2A6 机械臂腕部关节反馈34 (Len: 8)

* **Byte 0-3**: J3角度 (int32, 单位 0.001°, 分为最高位/次高位/次低位/最低位)
* **Byte 4-7**: J4角度 (int32, 单位 0.001°, 分为最高位/次高位/次低位/最低位)

### ID: 0x2A7 机械臂腕部关节反馈56 (Len: 8)

* **Byte 0-3**: J5角度 (int32, 单位 0.001°, 分为最高位/次高位/次低位/最低位)
* **Byte 4-7**: J6角度 (int32, 单位 0.001°, 分为最高位/次高位/次低位/最低位)

### ID: 0x2A8 夹爪反馈指令 (Len: 8)

* **Byte 0-3**: 夹爪行程 (int32, 单位 0.001mm, 分为最高位/次高位/次低位/最低位)
* **Byte 4**: 夹爪扭矩 H (int16, 单位 0.001N/m)
* **Byte 5**: 夹爪扭矩 L
* **Byte 6: 状态码 (uint8)**
* Bit 0: 电源电压是否过低（0：正常 1：过低）
* Bit 1: 电机是否过温（0：正常 1：过温）
* Bit 2: 驱动器是否过流（0：正常 1：过流）
* Bit 3: 驱动器是否过温（0：正常 1：过温）
* Bit 4: 传感器状态（0：正常 1：异常）
* Bit 5: 驱动器错误状态（0：正常 1：错误）
* Bit 6: 驱动器使能状态（1：使能 0：失能）
* Bit 7: 回零状态（0：没有回零 1：已经回零，或已经回过零）


* **Byte 7**: 保留

---

## 5. 详细协议内容：机械臂运动控制

### ID: 0x150 (Len: 8)

* **Byte 0: 快速急停 (uint8)**
* 0x00: 无效
* 0x01: 快速急停
* 0x02: 恢复


* **Byte 1: 轨迹指令 (uint8)**
* 0x00: 关闭
* 0x01: 暂停当前规划
* 0x02: 开始/继续当前轨迹
* 0x03: 清除当前轨迹
* 0x04: 清除所有轨迹
* 0x05: 获取当前规划轨迹
* 0x06: 终止执行
* 0x07: 轨迹传输
* 0x08: 轨迹传输结束


* **Byte 2: 拖动示教指令**
* 0x00: 关闭
* 0x01: 开始示教记录（进入拖动示教模式）
* 0x02: 结束示教记录（退出拖动示教模式）
* 0x03: 执行示教轨迹（拖动示教轨迹复现）
* 0x04: 暂停执行
* 0x05: 继续执行（轨迹复现继续）
* 0x06: 终止执行
* 0x07: 运动到轨迹起点


* **Byte 3: 轨迹索引 (uint8)**
* 标记刚才传输的轨迹点为第N个轨迹点；N=0~255；主控收到后会应答 `0x476 byte0 = 0x50; byte 2=N`（详见0x476），未收到应答需要重传。


* **Byte 4: NameIndex_H (uint16)**
* 当前轨迹包名称索引,由NameIndex和crc组成（应答 `0x477 byte0=03`）


* **Byte 5: NameIndex_L**
* **Byte 6: crc16_H (uint16)**
* **Byte 7: crc16_L**
* *说明：Byte3~Byte7用于离线轨迹模式下的轨迹传输，其它模式下全部填充默认值0x0即可。*

### ID: 0x151 (Len: 8)

* **Byte 0: 控制模式 (uint8)**
* 0x00: 待机模式
* 0x01: CAN指令控制模式
* 0x02 示教模式
* 0x03: 以太网控制模式
* 0x04: wifi控制模式
* 0x07: 离线轨迹模式


* **Byte 1: MOVE模式 (uint8)**
* 0x00: MOVE P
* 0x01: MOVE J
* 0x02: MOVE L
* 0x03: MOVE C
* 0x04: MOVE M


* **Byte 2: 运动速度百分比 (uint8_t)**
* 0~100


* **Byte 3: mit模式 (uint8_t)**
* 0x00: 位置速度模式 （默认）
* 0xAD: MIT模式（用于主从模式）


* **Byte 4: 离线轨迹点停留时间 (uint8_t)**
* 0~254，单位：s，255：轨迹终止


* **Byte 5: 安装位置**
* 0x00: 无效值
* 0x01: 水平正装
* 0x02: 侧装左
* 0x03: 侧装右
* //接线朝后


* **Byte 6**: 保留
* **Byte 7**: 保留
* *说明：控制模式目前仅对用户开放 0x01 CAN指令控制模式；作为模式切换指令时，Byte2~Byte7全部填充默认值0x0即可。*

### ID: 0x152 机械臂运动控制直角坐标指令1 (Len: 8)

* **Byte 0-3**: X坐标 (int32, 单位 0.001mm, 最高位/次高位/次低位/最低位)
* **Byte 4-7**: Y坐标 (int32, 单位 0.001mm, 最高位/次高位/次低位/最低位)

### ID: 0x153 机械臂运动控制旋转坐标指令2 (Len: 8)

* **Byte 0-3**: Z坐标 (int32, 单位 0.001mm, 最高位/次高位/次低位/最低位)
* **Byte 4-7**: RX角度 (int32, 单位 0.001°, 最高位/次高位/次低位/最低位)

### ID: 0x154 机械臂运动控制旋转坐标指令3 (Len: 8)

* **Byte 0-3**: RY角度 (int32, 单位 0.001°, 最高位/次高位/次低位/最低位)
* **Byte 4-7**: RZ角度 (int32, 单位 0.001°, 最高位/次高位/次低位/最低位)

### ID: 0x155 机械臂臂部关节控制指令12 (Len: 8)

* **Byte 0-3**: J1角度 (int32, 单位 0.001°, 最高位/次高位/次低位/最低位)
* **Byte 4-7**: J2角度 (int32, 单位 0.001°, 最高位/次高位/次低位/最低位)

### ID: 0x156 机械臂腕部关节控制指令34 (Len: 8)

* **Byte 0-3**: J3角度 (int32, 单位 0.001°, 最高位/次高位/次低位/最低位)
* **Byte 4-7**: J4角度 (int32, 单位 0.001°, 最高位/次高位/次低位/最低位)

### ID: 0x157 机械臂腕部关节控制指令56 (Len: 8)

* **Byte 0-3**: J5角度 (int32, 单位 0.001°, 最高位/次高位/次低位/最低位)
* **Byte 4-7**: J6角度 (int32, 单位 0.001°, 最高位/次高位/次低位/最低位)

### ID: 0x158 圆弧模式坐标序号更新指令 (Len: 1)

* **Byte 0: 指令点序号 (uint8)**
* 0x00: 无效
* 0x01: 起点
* 0x02: 中点
* 0x03: 终点



### ID: 0x159 夹爪控制指令 (Len: 8)

* **Byte 0-3**: 夹爪行程 (int32, 单位 0.001mm, 最高位~最低位)
* **Byte 4**: 夹爪扭矩 H (int16, 单位 0.001N/m)
* **Byte 5**: 夹爪扭矩 L
* **Byte 6: 夹爪使能/失能/清除错误 (uint8)**
* bit0: 置1:使能 0:失能
* bit1: 置1：清除错误


* **Byte 7: 夹爪零点设置 (uint8)**
* 无效值（默认）：0x00
* 0xAE（设置当前为零点）


* *说明：夹爪行程0值表示完全闭合；设置夹爪零点的时候Byte 6填充0x0 (失能)，Byte 7填充0xAE，设置成功夹爪行程反馈就会变成0（或接近0的值）。*

### ID: 0x15A ~ 0x15F 机械臂关节1~6 MIT控制指令 (Len: 8)

* **Byte 0**: Pos_ref [bit15~bit8] (uint8)
* **Byte 1**: Pos_ref [bit7~bit0] (uint8)
* **Byte 2**: Vel_ref [bit11~bit4] (uint8)
* **Byte 3**: Vel_ref [bit3~bit0] | Kp [bit11~bit8] (uint8)
* **Byte 4**: Kp [bit7~bit0] (uint8) —— Kp给定参考值：10
* **Byte 5**: Kd [bit11~bit4] (uint8) —— Kd给定参考值：0.8
* **Byte 6**: Kd [bit3~bit0] | T_ref [bit7~bit4] (uint8)
* **Byte 7**: T_ref [bit3~bit0] | CRC [bit3~bit0] (uint8)

转换代码：

float uint_to_float(int x_int, float x_min, float x_max, int bits)
{
    float span = x_max - x_min;
    float offset = x_min;
    return ((float)x_int)*span/((float)((1<<bits)-1)) + offset;
}

int float_to_uint(float x, float x_min, float x_max, int bits)
{
    float span = x_max - x_min;
    float offset = x_min;
    return (int) ((x-offset)*((float)((1<<bits)-1))/span);
}

---

## 6. 详细协议内容：配置与设定

### ID: 0x470 随动主从模式设置指令 (Len: 4)

* **Byte 0: 联动设置指令 (uint8)**
* 0x00: 无效
* 0xFA: 设置为示教输入臂
* 0xFC: 设置为运动输出臂


* **Byte 1: 反馈指令偏移值 (uint8)**
* 0x00: 不偏移/恢复默认
* 0x10: 反馈指令基ID由2Ax偏移为2Bx
* 0x20: 反馈指令基ID由2Ax偏移为2Cx


* **Byte 2: 控制指令偏移值 (uint8)**
* 0x00: 不偏移/恢复默认
* 0x10: 控制指令基ID由15x偏移为16x
* 0x20: 控制指令基ID由15x偏移为17x


* **Byte 3: 联动模式控制目标地址偏移值 (uint8)**
* 0x00: 不偏移/恢复默认
* 0x10: 控制目标地址基ID由15x偏移为16x
* 0x20: 控制目标地址基ID由15x偏移为17x


* *说明：随动主从模式支持ID偏移值配对的示教输入臂同步控制运动输出臂。1.设置为示教输入臂后，需要重启或者进入待机模式后方可切换为联动示教输入模式，此模式下不响应控制指令，不再主动发送周期反馈报文，且会主动发送关节模式控制指令；设置成功会保存到flash，掉电不丢失。2.设置为运动输出臂后恢复为常规状态（退出联动示教输入模式，进入待机模式）；未收到此条指令的机械臂默认为此状态。*

### ID: 0x471 电机使能/失能设置指令

* **Byte 0: 关节电机序号 (uint8)**
* 值域1-7: 1-6代表关节驱动器序号；7代表全部关节电机


* **Byte 1: 使能/失能 (uint8)**
* 0x01: 失能
* 0x02: 使能


* **Byte 2-7**: 保留

### ID: 0x472 查询电机角度/最大速度/最大加速度限制指令

* **Byte 0: 关节电机序号 (uint8)**
* 值域1-6: 1-6代表关节驱动器序号


* **Byte 1: 查询内容**
* 0x01: 查询电机角度/最大速度
* 0x02: 查询电机最大加速度限制


* **Byte 2-7**: 保留

### ID: 0x473 反馈当前电机限制角度/最大速度

* **Byte 0**: 关节电机序号 (uint8, 值域1-6)
* **Byte 1**: 最大角度限制 H (int16, 单位 0.1°)
* **Byte 2**: 最大角度限制 L
* **Byte 3**: 最小角度限制 H (int16, 单位 0.1°)
* **Byte 4**: 最小角度限制 L
* **Byte 5**: 最大关节速度 H (uint16, 单位 0.01rad/s)
* **Byte 6**: 最大关节速度 L
* **Byte 7**: 保留

### ID: 0x474 电机角度限制/最大速度设置指令

* **Byte 0**: 关节电机序号 (uint8, 值域1-6)
* **Byte 1**: 最大角度限制 H (int16, 单位 0.1°, 无效值：0x7FFF)
* **Byte 2**: 最大角度限制 L
* **Byte 3**: 最小角度限制 H (int16, 单位 0.1°, 无效值：0x7FFF)
* **Byte 4**: 最小角度限制 L
* **Byte 5**: 最大关节速度 H (uint16, 单位 0.01rad/s, 无效值：0x7FFF)
* **Byte 6**: 最大关节速度 L
* **Byte 7**: 保留

### ID: 0x475 关节设置指令

* **Byte 0**: 关节电机序号 (uint8, 值域1-7, 7代表全部)
* **Byte 1**: 设置N号电机当前位置为零点 (uint8, 有效值：0xAE)
* **Byte 2**: 加速度参数设置是否生效 (uint8, 有效值：0xAE)
* **Byte 3**: 最大关节加速度 H (uint16, 单位 0.01rad/s^2, 无效值：0x7FFF)
* **Byte 4**: 最大关节加速度 L
* **Byte 5**: 清除关节错误代码 (uint8, 有效值：0xAE)
* **Byte 6-7**: 保留

### ID: 0x476 设置指令应答

* **Byte 0**: 应答指令索引 (uint8)
* 取设置指令id最后一个字节，例如：应答0x471设置指令时此位填充0x71


* **Byte 1**: 零点是否设置成功 (uint8)
* 0x01: 零点成功设置
* 0x00: 设置失败/未设置
* (仅在关节设置指令--成功设置N号电机当前位置为零点时应答0x01)


* **Byte 2**: 轨迹点传输成功应答 (uint8, 轨迹传输点数索引N=0~255)
* **Byte 3**: 轨迹包传输完成应答 (uint8)
* 传输完成且校验成功，应答0xAE，校验失败应答0xEE，此时需要整包重传


* **Byte 4**: NameIndex_H (uint16)
* 当前轨迹包名称索引,由NameIndex和crc组成（应答0x477 byte0=03）


* **Byte 5**: NameIndex_L
* **Byte 6**: crc16_H (uint16)
* **Byte 7**: crc16_L

### ID: 0x477 机械臂参数查询与设置指令

* **Byte 0: 参数查询 (uint8)**
* 0x01: 查询末端V/acc参数
* 0x02: 查询碰撞防护等级
* 0x03: 查询当前轨迹索引
* 0x04: 查询夹爪/示教器参数索引


* **Byte 1: 参数设置 (uint8)**
* 0x01: 设置末端V/acc参数为初始值
* 0x02: 设置全部关节限位、关节最大速度、关节加速度为默认值


* **Byte 2: 0x48X报文反馈设置 (uint8)**
* 0x00: 无效
* 0x01: 开启周期反馈 (开启后周期上报1~6号关节当前末端速度/加速度)
* 0x02: 关闭周期反馈


* **Byte 3**: 末端负载参数设置是否生效 (uint8, 有效值：0xAE)
* **Byte 4: 设置末端负载 (uint8)**
* 0x00: 空载
* 0x01: 半载
* 0x02: 满载


* **Byte 5-7**: 保留 (uint8)

### ID: 0x478 反馈当前末端速度/加速度参数

* **Byte 0**: 末端最大线速度 H (uint16, 单位 0.001m/s)
* **Byte 1**: 末端最大线速度 L
* **Byte 2**: 末端最大角速度 H (uint16, 单位 0.001rad/s)
* **Byte 3**: 末端最大角速度 L
* **Byte 4**: 末端最大线加速度 H (单位 0.001m/s^2)
* **Byte 5**: 末端最大线加速度 L
* **Byte 6**: 末端最大角加速度 H (uint16, 单位 0.001rad/s^2)
* **Byte 7**: 末端最大角加速度 L

### ID: 0x479 末端速度/加速度参数设置指令

* **Byte 0**: 末端最大线速度 H (uint16, 单位 0.001m/s, 无效值：0x7FFF)
* **Byte 1**: 末端最大线速度 L
* **Byte 2**: 末端最大角速度 H (uint16, 单位 0.001rad/s, 无效值：0x7FFF)
* **Byte 3**: 末端最大角速度 L
* **Byte 4**: 末端最大线加速度 H (uint16, 单位 0.001m/s^2, 无效值：0x7FFF)
* **Byte 5**: 末端最大线加速度 L
* **Byte 6**: 末端最大角加速度 H (uint16, 单位 0.001rad/s^2, 无效值：0x7FFF)
* **Byte 7**: 末端最大角加速度 L

### ID: 0x47A 碰撞防护等级设置指令

* **Byte 0**: 1号关节碰撞防护等级 (uint8, 当前设定值：0~8, 等级0代表不检测碰撞；6个关节可以独立设置)
* **Byte 1**: 2号关节碰撞防护等级 (uint8)
* **Byte 2**: 3号关节碰撞防护等级 (uint8)
* **Byte 3**: 4号关节碰撞防护等级 (uint8)
* **Byte 4**: 5号关节碰撞防护等级 (uint8)
* **Byte 5**: 6号关节碰撞防护等级 (uint8)
* **Byte 6-7**: 保留

### ID: 0x47B 碰撞防护等级设置反馈指令

* **Byte 0**: 1号关节碰撞防护等级 (uint8, 有效值：0~8, 等级0代表不检测碰撞)
* **Byte 1**: 2号关节碰撞防护等级 (uint8)
* **Byte 2**: 3号关节碰撞防护等级 (uint8)
* **Byte 3**: 4号关节碰撞防护等级 (uint8)
* **Byte 4**: 5号关节碰撞防护等级 (uint8)
* **Byte 5**: 6号关节碰撞防护等级 (uint8)
* **Byte 6-7**: 保留

### ID: 0x47C 反馈当前电机最大加速度限制

* **Byte 0**: 关节电机序号 (uint8, 值域1-6)
* **Byte 1**: 最大关节加速度 H (uint16, 单位 0.001rad/s^2)
* **Byte 2**: 最大关节加速度 L
* **Byte 3-7**: 保留

### ID: 0x47D 夹爪/示教器参数设置指令

* **Byte 0: 示教器行程系数设置 (uint8)**
* 范围：100~200，单位：%（默认100%）。仅适用于设置主从臂的主臂，用于放大控制行程给从臂。


* **Byte 1: 夹爪/示教器最大控制行程限制值设置 (uint8)**
* 单位：mm。无效值：0。小夹爪为70mm，大夹爪为100mm。


* **Byte 2**: 示教器摩擦系数设置 (uint8, 1—10)
* **Byte 3-7**: 保留

### ID: 0x47E 夹爪/示教器参数反馈指令

* **Byte 0**: 示教器行程系数反馈 (uint8, 100~200, 单位 %)
* **Byte 1**: 夹爪/示教器最大控制行程限制值反馈 (uint8, 单位mm, 默认小夹爪)
* **Byte 2**: 示教器摩擦系数反馈 (uint8, 1—10)
* **Byte 3-7**: 保留

---

## 7. 其它反馈与功能

### ID: 0x481 ~ 0x486 反馈各个关节当前末端速度/加速度

* *0x481 ~ 0x486 代表1~6号关节*
* **Byte 0**: 末端线速度 H (uint16, 单位 0.001m/s)
* **Byte 1**: 末端线速度 L
* **Byte 2**: 末端角速度 H (uint16, 单位 0.001rad/s)
* **Byte 3**: 末端角速度 L
* **Byte 4**: 末端线加速度 H (uint16, 单位 0.001m/s^2)
* **Byte 5**: 末端线加速度 L
* **Byte 6**: 末端角加速度 H (uint16, 单位 0.001rad/s^2)
* **Byte 7**: 末端角加速度 L

### ID: 0x121 灯光控制指令

* **节点ID**: 0x1
* **帧ID**: 0X121
* **超时时间**: 无
* **数据长度**: 0x08
* **Byte 0: 灯光控制使能标志 (unsigned int8)**
* 0x00: 控制指令无效
* 0x01: 灯光控制使能


* **Byte 1**: 关节序号 (unsigned int8, 值域：1~6)
* **Byte 2**: 灯珠序号 (unsigned int8, 0-254，0xFF表示同时操作全部)
* **Byte 3**: R通道灰度值 (unsigned int8, 值域：0~255)
* **Byte 4**: G通道灰度值 (unsigned int8, 值域：0~255)
* **Byte 5**: B通道灰度值 (unsigned int8, 值域：0~255)
* **Byte 6**: 保留 (0x00)
* **Byte 7**: 计数校验 (unsigned int8, 0-255循环计数)

### ID: 0x251~0x256 关节驱动器信息高速反馈 (0x5)

* **节点ID**: 0x1~0x06
* **帧ID**: 0X251~0x256
* **反馈周期**: 20ms
* **数据长度**: 0x08
* **Byte 0**: 转速高八位 (signed int16, 电机当前转速 单位 0.001rad/s)
* **Byte 1**: 转速低八位
* **Byte 2**: 电流高八位 (unsigned int16, 电机当前电流 单位：0.001A)
* **Byte 3**: 电流低八位
* **Byte 4**: 位置最高位 (signed int32, 电机当前位置 单位：rad)
* **Byte 5**: 位置次高位
* **Byte 6**: 位置次低位
* **Byte 7**: 位置最低位

### ID: 0x261~0x266 关节驱动器信息低速反馈 (0x6)

* **节点ID**: 0x1~0x06
* **帧ID**: 0X261~0x266
* **反馈周期**: 100ms
* **数据长度**: 0x08
* **Byte 0**: 电压高八位 (unsigned int16, 当前驱动器电压单位：0.1V)
* **Byte 1**: 电压低八位
* **Byte 2**: 驱动器温度高八位 (signed int16, 单位：1℃)
* **Byte 3**: 驱动器温度低八位
* **Byte 4**: 电机温度 (signed int8, 单位：1℃)
* **Byte 5: 驱动器状态 (unsigned int8)**
* Bit 0: 电源电压是否过低（0：正常 1：过低）
* Bit 1: 电机是否过温（0：正常 1：过温）
* Bit 2: 驱动器是否过流（0：正常 1：过流）
* Bit 3: 驱动器是否过温（0：正常 1：过温）
* Bit 4: 碰撞保护状态（0：正常 1：触发保护）
* Bit 5: 驱动器错误状态（0：正常 1：错误）
* Bit 6: 驱动器使能状态（0：失能 1：使能）
* Bit 7: 堵转保护状态（0：正常 1：触发保护）


* **Byte 6**: 母线电流高八位 (unsigned int16, 当前驱动器电流 单位：0.001A，1.5KG关节电机无母线电流采样，默认发送0)
* **Byte 7**: 母线电流低八位

### ID: 0x422 固件升级模式设定指令

* **发送节点**: 决策控制单元
* **接收节点**: 机械臂主控
* **ID**: 0x422
* **数据长度**: 0x01
* **Byte 0 (unsigned int8)**:
* 0x00: 退出 固件升级模式(默认状态)
* 0x01: 进入CAN升级外部总线静默模式 (用于升级主控)
* 0x02: 进入内外网组合升级模式 (用于升级主控以及内网设备) —— 内外网总线静默，主控进入内外网CAN透传模式，退出后恢复数据反馈
